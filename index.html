<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <title>PaieNet.fr ‚Äì Calculateur Salaire Brut en Net 2025 (Gratuit)</title>
  <meta name="description" content="Le convertisseur de salaire de r√©f√©rence. Calculez votre Net √† Payer, Net Imposable et Co√ªt Employeur en temps r√©el. Simple, pr√©cis et gratuit.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="index, follow">
  
  <link rel="canonical" href="https://paienet.fr/">
  
  <!-- SEO -->
  <meta property="og:site_name" content="PaieNet.fr">
  <meta property="og:title" content="Combien allez-vous vraiment toucher ? - Simulateur PaieNet">
  <meta property="og:description" content="Convertissez votre brut en net instantan√©ment. Outil gratuit pour le secteur priv√©, cadre et fonction publique.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://paienet.fr/">
  <meta property="og:image" content="https://paienet.fr/share-image.jpg">

  <!-- GOOGLE ANALYTICS 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-053E5TJ1PX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-053E5TJ1PX');
  </script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            slate: { 850: '#1e293b', 900: '#0f172a' }
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Inter', sans-serif; }
    .fade-in { animation: fadeIn 0.4s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }

    .toggle-checkbox:checked { right: 0; border-color: #2563eb; }
    .toggle-checkbox:checked + .toggle-label { background-color: #2563eb; }

    .pie-chart { width: 100px; height: 100px; border-radius: 50%; position: relative; background: #e2e8f0; transition: background 0.3s; }
    .pie-chart::after { content: ""; position: absolute; inset: 12px; background: #f8fafc; border-radius: 50%; transition: background 0.3s; }
    .dark .pie-chart::after { background: #1e293b; }

    .input-result { background: transparent; border: 1px dashed transparent; width: 100%; transition: all 0.2s; }
    .input-result:hover, .input-result:focus { border-color: #93c5fd; outline: none; border-radius: 4px; }
    .dark .input-result:hover, .dark .input-result:focus { background: #1e293b; border-color: #3b82f6; }

    .pay-slip-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #e2e8f0; font-size: 0.875rem; }
    .dark .pay-slip-row { border-bottom-color: #334155; }
    .pay-slip-row:last-child { border-bottom: none; }

    /* --- STYLE IMPRESSION PDF PRO --- */
    #print-document { display: none; } 

    @media print {
      body > *:not(#print-document) { display: none !important; }
      
      body { 
        background: white !important; 
        color: #1e293b !important; 
        font-family: 'Inter', sans-serif;
        font-size: 11px;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        margin: 0; padding: 0;
      }
      
      #print-document { 
        display: block !important; 
        position: absolute; 
        top: 0; left: 0; width: 100%; 
        padding: 40px; box-sizing: border-box;
      }
      
      .pdf-watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); font-size: 120px; font-weight: 900; color: #f1f5f9; z-index: -1; pointer-events: none; opacity: 0.5; }

      .pdf-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; border-bottom: 2px solid #2563eb; padding-bottom: 20px; }
      .pdf-logo-text { font-size: 24px; font-weight: 800; color: #0f172a; letter-spacing: -1px; }
      .pdf-logo-accent { color: #2563eb; }
      .pdf-meta { text-align: right; }
      .pdf-title { font-size: 16px; font-weight: bold; text-transform: uppercase; color: #2563eb; margin-bottom: 5px; }
      
      .pdf-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 30px; }
      .pdf-box { background: #f8fafc !important; padding: 15px; border-radius: 6px; border: 1px solid #e2e8f0; }
      .pdf-box-label { font-size: 9px; text-transform: uppercase; letter-spacing: 0.5px; color: #64748b; margin-bottom: 5px; font-weight: 600; }
      .pdf-box-value { font-size: 12px; font-weight: 700; color: #0f172a; }

      .pdf-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
      .pdf-table th { text-align: left; padding: 10px; background-color: #0f172a !important; color: white !important; font-weight: 600; font-size: 10px; text-transform: uppercase; border-radius: 4px 4px 0 0; }
      .pdf-table td { padding: 12px 10px; border-bottom: 1px solid #e2e8f0; font-size: 11px; }
      .pdf-table tr:last-child td { border-bottom: none; }
      .col-right { text-align: right; }
      
      .pdf-summary { display: flex; justify-content: flex-end; margin-bottom: 40px; }
      .pdf-total-box { width: 250px; background: #eff6ff !important; border: 1px solid #2563eb; border-radius: 6px; padding: 15px; }
      .pdf-total-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 11px; }
      .pdf-total-row.final { border-top: 1px dashed #2563eb; padding-top: 8px; margin-top: 8px; font-weight: 900; font-size: 16px; color: #1e3a8a; }

      .pdf-footer-section { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #e2e8f0; padding-top: 15px; margin-top: 60px; }
      .pdf-legal { font-size: 8px; color: #94a3b8; max-width: 70%; line-height: 1.4; }
      .pdf-qr { width: 60px; height: 60px; background: #fff; border: 1px solid #ddd; padding: 2px; }
    }
  </style>

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "PaieNet - Calculateur Salaire France",
    "url": "https://paienet.fr",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR" },
    "featureList": "Brut Net, Dark Mode, Co√ªt Employeur, Comparateur salaire m√©dian"
  }
  </script>
</head>

<body class="bg-slate-50 text-slate-800 flex flex-col min-h-screen transition-colors duration-300 dark:bg-slate-900 dark:text-slate-100">

  <!-- Header -->
  <header class="bg-white border-b border-slate-200 sticky top-0 z-20 shadow-sm no-print dark:bg-slate-800 dark:border-slate-700 transition-colors duration-300">
    <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
      <a href="index.html" class="flex items-center gap-2 group">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 text-white rounded-xl shadow-lg flex items-center justify-center transform group-hover:rotate-3 transition-transform duration-300">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
        </div>
        <div class="flex flex-col justify-center">
          <span class="text-xl font-bold text-slate-900 tracking-tight leading-none dark:text-white">Paie<span class="text-blue-600">Net</span></span>
          <span class="block text-[10px] font-semibold text-slate-400 uppercase tracking-widest mt-0.5 group-hover:text-blue-500 transition-colors">Salaire & Imp√¥ts</span>
        </div>
      </a>
      <div class="flex items-center gap-3">
        <button id="themeToggle" onclick="toggleTheme()" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition text-slate-500 dark:text-slate-400">
          <svg id="iconSun" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
          <svg id="iconMoon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-8 md:py-10 flex-grow">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
      
      <!-- CALCULATEUR -->
      <div class="lg:col-span-8 space-y-6">
        <div id="main-container" class="bg-white rounded-2xl shadow-lg border border-slate-100 p-6 md:p-8 dark:bg-slate-800 dark:border-slate-700 transition-colors">
          
          <div class="flex justify-between items-start mb-2 no-print">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900 dark:text-white">Convertisseur Brut <span class="text-blue-600">‚Üî</span> Net</h1>
            <div class="flex flex-col items-end gap-1">
               <span id="shareMsg" class="hidden text-xs text-green-600 font-medium bg-green-50 dark:bg-green-900/30 dark:text-green-400 px-2 py-1 rounded">Lien copi√© !</span>
               <span id="copyTextMsg" class="hidden text-xs text-blue-600 font-medium bg-blue-50 dark:bg-blue-900/30 dark:text-blue-400 px-2 py-1 rounded">R√©sum√© copi√© !</span>
            </div>
          </div>
          <p class="text-slate-500 mb-6 text-sm md:text-base no-print dark:text-slate-400">Estimez le salaire Net, les cotisations et le Co√ªt Employeur.</p>

          <!-- OPTIONS -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 bg-slate-50 p-4 rounded-xl border border-slate-200 no-print dark:bg-slate-700/50 dark:border-slate-600">
            <div>
              <label class="block text-xs font-semibold text-slate-500 uppercase mb-1.5 dark:text-slate-400">Votre Statut</label>
              <select id="statut" class="w-full text-sm border-slate-300 rounded-lg p-2.5 bg-white focus:ring-2 focus:ring-blue-500 outline-none cursor-pointer border shadow-sm dark:bg-slate-800 dark:border-slate-600 dark:text-white">
                <option value="non_cadre" selected>üë§ Salari√© Non-Cadre</option>
                <option value="cadre">üëî Salari√© Cadre</option>
                <option value="public">üèõÔ∏è Fonction Publique</option>
                <option value="liberal">üíª Profession Lib√©rale</option>
              </select>
            </div>
            <div class="flex flex-col justify-between gap-3">
              <div class="flex items-center justify-between">
                <label class="text-sm font-medium text-slate-700 dark:text-slate-300">13√®me mois ?</label>
                <div class="relative inline-block w-10 mr-2 align-middle"><input type="checkbox" name="toggle" id="mois13" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer border-slate-300 left-0"/><label for="mois13" class="toggle-label block overflow-hidden h-5 rounded-full bg-slate-300 cursor-pointer"></label></div>
              </div>
              <div class="flex items-center gap-2">
                <label for="tauxImpot" class="text-sm font-medium text-slate-700 whitespace-nowrap dark:text-slate-300">Taux PAS (%) :</label>
                <input type="number" id="tauxImpot" placeholder="0" class="w-full p-1.5 text-sm border border-slate-300 rounded focus:ring-1 focus:ring-blue-500 outline-none text-right dark:bg-slate-800 dark:border-slate-600 dark:text-white" min="0" max="100" step="0.1">
              </div>
            </div>
          </div>

          <!-- INPUTS -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="relative group">
              <label class="block text-xs font-bold text-slate-500 uppercase mb-2 dark:text-slate-400">Brut Mensuel</label>
              <div class="relative">
                <input type="number" id="brutMensuel" placeholder="Ex: 2500" class="w-full pl-4 pr-10 py-3 rounded-lg border-2 border-slate-200 focus:border-blue-500 outline-none transition-all text-xl font-bold text-slate-800 placeholder-slate-300 shadow-sm dark:bg-slate-800 dark:border-slate-600 dark:text-white">
                <span class="absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 font-medium">‚Ç¨</span>
              </div>
            </div>
            <div class="relative group">
              <label class="block text-xs font-bold text-slate-500 uppercase mb-2 dark:text-slate-400">Brut Annuel</label>
              <div class="relative">
                <input type="number" id="brutAnnuel" placeholder="Ex: 30000" class="w-full pl-4 pr-10 py-3 rounded-lg border-2 border-slate-200 focus:border-blue-500 outline-none transition-all text-xl font-bold text-slate-800 placeholder-slate-300 shadow-sm dark:bg-slate-800 dark:border-slate-600 dark:text-white">
                <span class="absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 font-medium">‚Ç¨</span>
              </div>
            </div>
          </div>

          <!-- R√âSULTATS -->
          <div id="result" class="hidden bg-slate-50 rounded-xl border border-slate-200 overflow-hidden shadow-inner relative dark:bg-slate-900/50 dark:border-slate-700">
            <div class="bg-slate-100 px-6 py-2 border-b border-slate-200 flex justify-between items-center dark:bg-slate-800 dark:border-slate-700">
              <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-1">
                <span class="no-print">Champs Net modifiables</span>
                <span class="print-only">Synth√®se Mensuelle</span>
              </span>
              <span id="badgeStatut" class="px-2 py-0.5 rounded text-[10px] font-bold bg-white border border-slate-300 text-slate-500 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-300">NON CADRE</span>
            </div>

            <div class="p-6 grid grid-cols-1 md:grid-cols-12 gap-6">
              <div class="md:col-span-8 space-y-6">
                <div class="flex items-end justify-between border-b border-slate-200 pb-4 border-dashed dark:border-slate-700 relative">
                  <div class="w-full">
                    <span class="block text-blue-600 text-xs font-bold uppercase mb-1 dark:text-blue-400">Net √† payer (Avant Imp√¥t)</span>
                    <div class="relative flex items-center">
                      <input type="number" id="netMensuel" class="input-result text-4xl font-extrabold text-blue-600 tracking-tight placeholder-blue-200 w-full dark:text-blue-400 dark:placeholder-blue-900 p-0 pr-16" placeholder="0">
                      <span class="absolute right-0 top-1/2 -translate-y-1/2 text-sm text-slate-400 pointer-events-none font-medium">‚Ç¨ / mois</span>
                    </div>
                  </div>
                </div>
                <!-- SMIC Meter -->
                <div id="smicTag" class="hidden inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/50 dark:text-indigo-300">üöÄ <span id="smicMultiple" class="ml-1 font-bold"></span> x SMIC</div>

                <div class="grid grid-cols-2 gap-x-4 gap-y-6 mt-4">
                   <div>
                     <span class="block text-[10px] text-slate-400 uppercase font-semibold mb-1">Net Annuel</span>
                     <div class="relative"><input type="number" id="netAnnuel" class="input-result text-lg font-bold text-slate-700 w-full p-0 border-0 focus:ring-0 dark:text-slate-200" placeholder="0"><span class="absolute right-0 top-0 text-xs text-slate-400 pointer-events-none">‚Ç¨</span></div>
                   </div>
                   <div><span class="block text-[10px] text-slate-400 uppercase font-semibold mb-1">Net Imposable</span><span class="text-lg font-bold text-slate-700 block leading-none dark:text-slate-200"><span id="netImposable">0</span> ‚Ç¨</span></div>
                   <div><span class="block text-[10px] text-slate-400 uppercase font-semibold mb-1">Charges Salariales</span><span class="text-lg font-bold text-red-400 block leading-none">- <span id="coutCharges">0</span> ‚Ç¨</span></div>
                   <div><span class="block text-[10px] text-slate-400 uppercase font-semibold mb-1">Co√ªt Employeur</span><span class="text-lg font-bold text-slate-600 block leading-none dark:text-slate-400"><span id="coutEmployeur">0</span> ‚Ç¨</span></div>
                </div>

                <div id="blocImpot" class="flex items-center justify-between bg-white p-3 rounded-lg border border-blue-100 shadow-sm hidden mt-4 dark:bg-slate-800 dark:border-slate-700">
                  <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-green-500 animate-pulse no-print"></span><span class="text-sm font-semibold text-slate-700 dark:text-slate-200">Net APR√àS Imp√¥t</span></div>
                  <span class="text-xl font-bold text-green-600 dark:text-green-400"><span id="netApresImpot">0</span> ‚Ç¨</span>
                </div>
              </div>

              <div class="md:col-span-4 flex flex-col items-center justify-center border-l border-slate-200 pl-0 md:pl-6 pt-6 md:pt-0 border-t md:border-t-0 border-dashed dark:border-slate-700">
                <div id="chartPie" class="pie-chart shadow-sm"></div>
                <div class="mt-4 w-full space-y-2">
                  <div class="flex justify-between text-xs"><span class="flex items-center gap-1.5"><span class="w-2 h-2 rounded-full bg-blue-600"></span><span class="text-slate-600 dark:text-slate-300">Net</span></span><span class="font-bold text-slate-700 dark:text-slate-200" id="percentNet">--%</span></div>
                  <div class="flex justify-between text-xs"><span class="flex items-center gap-1.5"><span class="w-2 h-2 rounded-full bg-slate-300 dark:bg-slate-600"></span><span class="text-slate-600 dark:text-slate-300">Charges</span></span><span class="font-bold text-slate-700 dark:text-slate-200" id="percentCharges">--%</span></div>
                </div>
              </div>
            </div>

            <details id="detailsCotisations" class="group border-t border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700">
               <summary class="flex justify-between items-center p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50 transition no-print">
                 <span class="font-semibold text-sm text-slate-700 flex items-center gap-2 dark:text-slate-300">Voir le d√©tail (Simulation Fiche)</span>
                 <svg class="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
               </summary>
               <div class="p-6 pt-2">
                 <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 print-only">D√©tail des Cotisations (Estimation)</h4>
                 <div class="space-y-0">
                    <div class="pay-slip-row bg-slate-50/50 dark:bg-slate-700/30"><span class="pay-slip-label">Salaire Brut Mensuel</span><span class="pay-slip-value text-slate-900 dark:text-white" id="fpBrut">0 ‚Ç¨</span></div>
                    <div class="pay-slip-row"><span class="pay-slip-label pl-4 text-xs dark:text-slate-400">Total Charges Salariales</span><span class="pay-slip-value text-red-500 text-xs" id="fpTotalCharges">- 0 ‚Ç¨</span></div>
                    <div class="pay-slip-row bg-blue-50/30 border-t-2 border-slate-100 mt-2 pt-2 dark:bg-blue-900/20 dark:border-slate-700"><span class="pay-slip-label font-bold text-blue-900 dark:text-blue-300">Net √† Payer</span><span class="pay-slip-value text-blue-600 text-lg dark:text-blue-400" id="fpNet">0 ‚Ç¨</span></div>
                    <div class="pay-slip-row pt-1"><span class="pay-slip-label text-xs dark:text-slate-400">Dont CSG/CRDS non d√©ductible</span><span class="pay-slip-value text-xs text-slate-400" id="fpCsgNonDed">0 ‚Ç¨</span></div>
                    <div class="pay-slip-row bg-slate-100/50 pt-2 pb-2 mt-2 dark:bg-slate-700/50"><span class="pay-slip-label font-semibold text-slate-700 dark:text-slate-300">Net Imposable</span><span class="pay-slip-value text-slate-700 dark:text-slate-200" id="fpNetImposable">0 ‚Ç¨</span></div>
                    <div class="pay-slip-row mt-4 pt-4 border-t border-slate-200 dark:border-slate-700"><span class="pay-slip-label font-medium dark:text-slate-400">Co√ªt Total Employeur</span><span class="pay-slip-value dark:text-slate-300" id="fpCoutEmployeur">0 ‚Ç¨</span></div>
                 </div>
                 
                 <!-- BOUTON PDF INT√âGR√â ICI -->
                 <div class="mt-4 pt-2 text-center no-print">
                   <button onclick="window.print()" class="text-xs font-bold text-slate-500 hover:text-blue-600 flex items-center justify-center gap-2 mx-auto transition">
                      üìÑ T√©l√©charger la Fiche (PDF)
                   </button>
                 </div>
               </div>
            </details>
            
            <div class="absolute top-4 right-4 flex gap-1 no-print">
              <button onclick="resetCalc()" class="p-2 text-slate-400 hover:text-red-500 transition bg-white/50 hover:bg-white rounded-lg dark:bg-slate-700 dark:hover:bg-slate-600" title="R√©initialiser"><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg></button>
              <button onclick="copySummary()" class="p-2 text-slate-400 hover:text-blue-600 transition bg-white/50 hover:bg-white rounded-lg dark:bg-slate-700 dark:hover:bg-slate-600" title="Copier"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg></button>
              <button onclick="copyLink()" class="p-2 text-slate-400 hover:text-blue-600 transition bg-white/50 hover:bg-white rounded-lg dark:bg-slate-700 dark:hover:bg-slate-600" title="Lien"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg></button>
            </div>
          </div>
          <p class="text-[10px] text-slate-400 mt-4 text-center no-print">*Chiffres modifiables directement (Brut ou Net).</p>
        </div>

        <div id="seoGrid" class="mt-8 bg-white rounded-xl border border-slate-200 p-6 no-print dark:bg-slate-800 dark:border-slate-700">
          <h3 class="text-lg font-bold text-slate-900 mb-4 dark:text-white">Grille de conversion rapide (<span id="gridStatut">Non Cadre</span>)</h3>
          <div class="overflow-x-auto">
            <table class="w-full seo-table">
              <thead><tr><th>Brut Annuel</th><th>Brut Mensuel</th><th>Net Mensuel</th><th>Imposable (est.)</th></tr></thead>
              <tbody id="salaryTableBody"></tbody>
            </table>
          </div>
        </div>

        <article class="prose prose-sm prose-slate max-w-none bg-white p-6 rounded-2xl shadow-sm border border-slate-100 no-print mt-6 dark:bg-slate-800 dark:border-slate-700 dark:prose-invert">
          <h3>üí° Net √† Payer vs Net Imposable</h3>
          <p>Ne confondez pas ! Le <strong>Net √† Payer</strong> est ce qui arrive sur votre compte. Le <strong>Net Imposable</strong> est souvent plus √©lev√© (il inclut la CSG non d√©ductible) et sert de base au calcul de l'imp√¥t √† la source.</p>
          <h3>Comprendre le Co√ªt Employeur</h3>
          <p>Le "Super Brut" repr√©sente le co√ªt total pour l'entreprise (Salaire Brut + Charges Patronales).</p>
        </article>
      </div>

      <!-- SIDEBAR -->
      <div class="lg:col-span-4 space-y-6 no-print">
        
        <!-- ZONE PUBLICIT√â 1 (Haut - Finances) -->
        <div class="relative overflow-hidden rounded-2xl bg-white border border-slate-100 shadow-lg dark:bg-slate-800 dark:border-slate-700">
          <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500"></div>
          <div class="p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-sm font-bold text-slate-900 uppercase tracking-wide flex items-center gap-2 dark:text-white">
                <svg class="w-4 h-4 text-amber-500" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                Offres du moment
              </h3>
            </div>
            <div class="space-y-3">
              <!-- Offre Banque -->
              <a href="https://bour.so/p/RUhqIX1d2Cs" target="_blank" rel="noopener noreferrer" class="group block relative p-4 rounded-xl border border-slate-100 bg-gradient-to-br from-slate-50 to-white hover:from-blue-50 hover:to-white hover:border-blue-200 transition-all duration-300 shadow-sm hover:shadow-md dark:from-slate-700 dark:to-slate-800 dark:border-slate-600 dark:hover:border-blue-500/50">
                <div class="absolute top-3 right-3"><span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">+150‚Ç¨ offerts</span></div>
                <div class="flex items-start gap-3"><div class="bg-blue-100 p-2 rounded-lg text-blue-600 dark:bg-slate-600 dark:text-blue-300"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></div><div><div class="font-bold text-slate-800 text-sm group-hover:text-blue-700 transition-colors dark:text-slate-100">Compte 0‚Ç¨ frais</div><div class="text-xs text-slate-500 mt-1 leading-relaxed dark:text-slate-400">Arr√™tez de payer pour votre banque. Carte Gold incluse.</div></div></div>
              </a>
              <!-- Offre Invest -->
              <a href="https://ton-lien-invest.com" target="_blank" rel="noopener noreferrer" class="group block relative p-4 rounded-xl border border-slate-100 bg-gradient-to-br from-slate-50 to-white hover:from-purple-50 hover:to-white hover:border-purple-200 transition-all duration-300 shadow-sm hover:shadow-md dark:from-slate-700 dark:to-slate-800 dark:border-slate-600 dark:hover:border-purple-500/50">
                <div class="absolute top-3 right-3"><span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300">4% Garanti</span></div>
                <div class="flex items-start gap-3"><div class="bg-purple-100 p-2 rounded-lg text-purple-600 dark:bg-slate-600 dark:text-purple-300"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg></div><div><div class="font-bold text-slate-800 text-sm group-hover:text-purple-700 transition-colors dark:text-slate-100">Fructifiez votre salaire</div><div class="text-xs text-slate-500 mt-1 leading-relaxed dark:text-slate-400">Livret boost√© ou plan d'investissement programm√©.</div></div></div>
              </a>
            </div>
          </div>
        </div>

        <!-- FAQ -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5 dark:bg-slate-800 dark:border-slate-700">
          <h3 class="font-bold text-slate-900 mb-4 flex items-center gap-2 text-sm dark:text-white">Questions Fr√©quentes</h3>
          <div class="space-y-3 dark:text-slate-300">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">C'est quoi le Super Brut ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">C'est le co√ªt total pour l'entreprise (Salaire + charges patronales).</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">13√®me mois : comment √ßa marche ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Brut annuel multipli√© par 13, mais le mensuel de base reste le m√™me.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Brut ou Net pour n√©gocier ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Toujours n√©gocier en Brut Annuel. C'est la valeur contractuelle.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Net Imposable vs Net √† payer ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">L'imposable inclut la CSG non d√©ductible et sert au calcul de l'imp√¥t.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Mutuelle et Tickets Resto ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Non inclus, ils r√©duisent l√©g√®rement le net final selon l'entreprise.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Stage et Apprentissage ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Souvent exon√©r√©s de charges. Brut ‚âà Net.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Qu'est-ce que le Net Social ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Montant √† d√©clarer pour la CAF (Prime d'activit√©, RSA).</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Les primes sont-elles charg√©es ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Oui, comme le salaire (sauf participation/int√©ressement).</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">Pourquoi mon net varie ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Taux PAS actualis√© ou plafonds SS.</p></details>
             <hr class="border-slate-100 dark:border-slate-700">
             <details class="group text-sm"><summary class="cursor-pointer font-medium hover:text-blue-600 list-none flex justify-between">O√π trouver mon taux PAS ? <span class="group-open:rotate-180">‚ñº</span></summary><p class="text-slate-500 mt-2 text-xs dark:text-slate-400">Sur impots.gouv.fr ou votre fiche de paie.</p></details>
          </div>
        </div>

        <!-- ZONE PUBLICIT√â 2 (Bas - Nouveau) -->
        <div class="relative overflow-hidden rounded-2xl bg-white border border-slate-100 shadow-lg dark:bg-slate-800 dark:border-slate-700 mt-6">
          <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-cyan-500 via-blue-500 to-indigo-500"></div>
          <div class="p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-sm font-bold text-slate-900 uppercase tracking-wide flex items-center gap-2 dark:text-white">
                <svg class="w-4 h-4 text-cyan-500" fill="currentColor" viewBox="0 0 20 20"><path d="M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V9.236a1 1 0 00-1.447-.894l-4 2a1 1 0 00-.553.894V17zM15.211 6.276a1 1 0 000-1.788l-4.764-2.382a1 1 0 00-.894 0L4.789 4.488a1 1 0 000 1.788l4.764 2.382a1 1 0 00.894 0l4.764-2.382zM4.447 8.342A1 1 0 003 9.236V15a1 1 0 00.553.894l4 2A1 1 0 009 17v-5.764a1 1 0 00-.553-.894l-4-2z" /></svg>
                Formation & Carri√®re
              </h3>
            </div>
            <div class="space-y-3">
              <a href="#" target="_blank" rel="noopener noreferrer" class="group block relative p-4 rounded-xl border border-slate-100 bg-gradient-to-br from-slate-50 to-white hover:from-cyan-50 hover:to-white hover:border-cyan-200 transition-all duration-300 shadow-sm hover:shadow-md dark:from-slate-700 dark:to-slate-800 dark:border-slate-600 dark:hover:border-cyan-500/50">
                <div class="absolute top-3 right-3"><span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-cyan-100 text-cyan-800 dark:bg-cyan-900/50 dark:text-cyan-300">Nouveau</span></div>
                <div class="flex items-start gap-3">
                  <div class="bg-cyan-100 p-2 rounded-lg text-cyan-600 dark:bg-slate-600 dark:text-cyan-300"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path></svg></div>
                  <div><div class="font-bold text-slate-800 text-sm group-hover:text-cyan-700 transition-colors dark:text-slate-100">Bilan de Comp√©tences</div><div class="text-xs text-slate-500 mt-1 leading-relaxed dark:text-slate-400">Faites le point sur votre carri√®re gratuitement.</div></div>
                </div>
              </a>
              <!-- Ajout de la 2√®me offre Carri√®re pour √©quilibrer -->
              <a href="#" target="_blank" rel="noopener noreferrer" class="group block relative p-4 rounded-xl border border-slate-100 bg-gradient-to-br from-slate-50 to-white hover:from-blue-50 hover:to-white hover:border-blue-200 transition-all duration-300 shadow-sm hover:shadow-md dark:from-slate-700 dark:to-slate-800 dark:border-slate-600 dark:hover:border-blue-500/50">
                <div class="absolute top-3 right-3"><span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300">Boost</span></div>
                <div class="flex items-start gap-3">
                  <div class="bg-blue-100 p-2 rounded-lg text-blue-600 dark:bg-slate-600 dark:text-blue-300"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div>
                  <div><div class="font-bold text-slate-800 text-sm group-hover:text-blue-700 transition-colors dark:text-slate-100">Devenir Freelance</div><div class="text-xs text-slate-500 mt-1 leading-relaxed dark:text-slate-400">Testez vos revenus avec notre simulateur d√©di√©.</div></div>
                </div>
              </a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- CONTENEUR PDF CACH√â (MODELE BULLETIN DE SALAIRE) -->
  <div id="print-document">
    <div class="pdf-watermark">PaieNet</div>
    <div class="pdf-header">
      <div>
         <div class="pdf-title">SIMULATION DE BULLETIN DE SALAIRE</div>
         <div class="pdf-subtitle">Estimation Salari√© Secteur Priv√© 2025</div>
      </div>
      <div class="pdf-meta">
         <div class="pdf-logo-text">Paie<span class="pdf-logo-accent">Net</span></div>
         <div style="font-size:10px; color:#94a3b8; margin-top:5px;">R√©f: <span id="pdfRef">SAL-2025</span></div>
         <div style="font-size:10px; color:#94a3b8;" id="pdfDate"></div>
      </div>
    </div>

    <div class="pdf-grid">
       <div class="pdf-box">
         <div class="pdf-box-label">VOTRE STATUT</div>
         <div class="pdf-box-value" id="pdfStatut">Non Cadre</div>
       </div>
       <div class="pdf-box" style="text-align:right;">
         <div class="pdf-box-label">SALAIRE BRUT MENSUEL</div>
         <div class="pdf-box-value" style="font-size:18px; color:#0f172a;" id="pdfBrut">0 ‚Ç¨</div>
       </div>
    </div>

    <table class="pdf-table">
       <thead>
          <tr>
             <th>D√©signation</th>
             <th class="col-right">Taux / Base</th>
             <th class="col-right">Part Salariale</th>
          </tr>
       </thead>
       <tbody>
          <tr>
             <td>Salaire Brut (Base)</td>
             <td class="col-right">100%</td>
             <td class="col-right" id="pdfBrutTable" style="font-weight:bold;">0 ‚Ç¨</td>
          </tr>
          <tr>
             <td>Charges Sociales (Retraite, Sant√©, Ch√¥mage)</td>
             <td class="col-right">~23%</td>
             <td class="col-right" id="pdfCharges">- 0 ‚Ç¨</td>
          </tr>
          <tr>
             <td>Net Imposable (Estimation)</td>
             <td class="col-right">-</td>
             <td class="col-right" id="pdfImposable">0 ‚Ç¨</td>
          </tr>
          <tr>
             <td>Net √† Payer (Avant Imp√¥t)</td>
             <td class="col-right">-</td>
             <td class="col-right" id="pdfNetAvant" style="font-weight:bold; color:#2563eb;">0 ‚Ç¨</td>
          </tr>
          <tr>
             <td>Pr√©l√®vement √† la Source (PAS)</td>
             <td class="col-right" id="pdfTauxPas">0%</td>
             <td class="col-right" id="pdfMontantPas">- 0 ‚Ç¨</td>
          </tr>
       </tbody>
    </table>

    <div class="pdf-summary">
       <div class="pdf-total-box">
          <div class="pdf-total-row">
             <span>Co√ªt Total Employeur</span>
             <span id="pdfCoutPatronal">0 ‚Ç¨</span>
          </div>
          <div class="pdf-total-row final">
             <span>NET √Ä PAYER</span>
             <span id="pdfNetApres">0 ‚Ç¨</span>
          </div>
       </div>
    </div>
    
    <div class="pdf-footer-section">
       <div class="pdf-legal">Document g√©n√©r√© √† titre indicatif sur PaieNet.fr. Ce document n'est pas un bulletin de paie officiel et ne peut √™tre utilis√© comme tel.</div>
       <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://paienet.fr" class="pdf-qr" alt="QR PaieNet" />
    </div>
  </div>

  <footer class="bg-white border-t border-slate-200 mt-auto py-6 no-print dark:bg-slate-800 dark:border-slate-700 text-center">
    <p class="text-slate-400 text-xs mb-2">¬© 2025 PaieNet.fr. Outil d'estimation gratuit.</p>
    <a href="mentions.html" class="text-xs text-blue-500 hover:underline">Mentions L√©gales</a>
    <span class="mx-2 text-slate-300">|</span>
    <a href="freelance.html" class="text-xs text-emerald-600 hover:text-emerald-500 font-bold">‚ûú Simulateur Auto-Entrepreneur</a>
  </footer>

  <!-- ENGINE JS V10 (PDF Salary) -->
  <script>
    const RATES = { non_cadre: 0.22, cadre: 0.25, public: 0.15, liberal: 0.45 };
    const EMPLOYER_RATES = { non_cadre: 0.42, cadre: 0.45, public: 0.45, liberal: 0 };
    const SMIC_NET_2025 = 1426; 
    const CSG_NON_DED_RATE = 0.029; 

    let el = {};

    document.addEventListener('DOMContentLoaded', () => {
      const d = new Date();
      if(document.getElementById('pdfDate')) document.getElementById('pdfDate').textContent = d.toLocaleDateString('fr-FR');
      if(document.getElementById('pdfRef')) document.getElementById('pdfRef').textContent = "SAL-2025-" + Math.floor(1000 + Math.random() * 9000);

      if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
        toggleIcons(true);
      }

      el = {
        brutMensuel: document.getElementById('brutMensuel'),
        brutAnnuel: document.getElementById('brutAnnuel'),
        netMensuel: document.getElementById('netMensuel'),
        netAnnuel: document.getElementById('netAnnuel'), // Restored
        statut: document.getElementById('statut'),
        mois13: document.getElementById('mois13'),
        tauxImpot: document.getElementById('tauxImpot'),
        result: document.getElementById('result'),
        netApresImpot: document.getElementById('netApresImpot'),
        netImposable: document.getElementById('netImposable'),
        coutCharges: document.getElementById('coutCharges'),
        coutEmployeur: document.getElementById('coutEmployeur'),
        fpCoutEmployeur: document.getElementById('fpCoutEmployeur'),
        badgeStatut: document.getElementById('badgeStatut'),
        blocImpot: document.getElementById('blocImpot'),
        chartPie: document.getElementById('chartPie'),
        percentNet: document.getElementById('percentNet'),
        percentCharges: document.getElementById('percentCharges'),
        // Fiche Paie
        fpBrut: document.getElementById('fpBrut'),
        fpTotalCharges: document.getElementById('fpTotalCharges'),
        fpNet: document.getElementById('fpNet'),
        fpCsgNonDed: document.getElementById('fpCsgNonDed'),
        fpNetImposable: document.getElementById('fpNetImposable'),
        smicTag: document.getElementById('smicTag'),
        smicMultiple: document.getElementById('smicMultiple'),
        // Grid
        salaryTableBody: document.getElementById('salaryTableBody'),
        gridStatut: document.getElementById('gridStatut'),
        // PDF Elements
        pdfStatut: document.getElementById('pdfStatut'),
        pdfBrut: document.getElementById('pdfBrut'),
        pdfBrutTable: document.getElementById('pdfBrutTable'),
        pdfCharges: document.getElementById('pdfCharges'),
        pdfImposable: document.getElementById('pdfImposable'),
        pdfNetAvant: document.getElementById('pdfNetAvant'),
        pdfTauxPas: document.getElementById('pdfTauxPas'),
        pdfMontantPas: document.getElementById('pdfMontantPas'),
        pdfCoutPatronal: document.getElementById('pdfCoutPatronal'),
        pdfNetApres: document.getElementById('pdfNetApres')
      };

      // Safe event listeners
      el.brutMensuel?.addEventListener('input', () => compute('brutMensuel'));
      el.brutAnnuel?.addEventListener('input', () => compute('brutAnnuel'));
      el.netMensuel?.addEventListener('input', () => compute('netMensuel'));
      el.netAnnuel?.addEventListener('input', () => compute('netAnnuel'));
      
      el.statut?.addEventListener('change', () => compute('option'));
      el.mois13?.addEventListener('change', () => compute('option'));
      el.tauxImpot?.addEventListener('input', () => compute('option'));

      loadFromUrl();
      generateGrid(); 
    });

    const compute = (source) => {
      if(!el.statut) return; 

      const nbMois = el.mois13?.checked ? 13 : 12;
      const tauxSal = RATES[el.statut.value] || 0.22;
      const tauxPat = EMPLOYER_RATES[el.statut.value] || 0;
      const impot = parseFloat(el.tauxImpot?.value) || 0;

      let monthlyGross = 0;

      // Logic bidirectionnelle
      if (source === 'brutMensuel') monthlyGross = parseFloat(el.brutMensuel.value);
      else if (source === 'brutAnnuel') monthlyGross = parseFloat(el.brutAnnuel.value) / nbMois;
      else if (source === 'netMensuel') monthlyGross = parseFloat(el.netMensuel.value) / (1 - tauxSal);
      else if (source === 'netAnnuel') monthlyGross = (parseFloat(el.netAnnuel.value) / nbMois) / (1 - tauxSal);
      else if (el.brutMensuel) monthlyGross = parseFloat(el.brutMensuel.value);

      if (!monthlyGross || isNaN(monthlyGross)) {
        if(source !== 'option') updateUrl();
        return; 
      }

      // Calculs Principaux
      const monthlyNet = monthlyGross * (1 - tauxSal);
      const chargesSal = monthlyGross - monthlyNet;
      const coutTotal = monthlyGross * (1 + tauxPat); 
      
      // Calcul Net Imposable (Estimation CSG Non D√©ductible)
      const csgNonDed = monthlyGross * 0.9825 * CSG_NON_DED_RATE;
      const monthlyImposable = monthlyNet + csgNonDed;

      // Calcul Net Apr√®s Imp√¥t (Bas√© sur le Net Imposable !)
      const impotMontant = (monthlyImposable * (impot / 100));
      const monthlyNetApresImpot = monthlyNet - impotMontant;

      // UI Updates
      const activeId = document.activeElement ? document.activeElement.id : null;
      
      if (el.brutMensuel && activeId !== 'brutMensuel') el.brutMensuel.value = monthlyGross.toFixed(0);
      if (el.brutAnnuel && activeId !== 'brutAnnuel') el.brutAnnuel.value = (monthlyGross * nbMois).toFixed(0);
      if (el.netMensuel && activeId !== 'netMensuel') el.netMensuel.value = monthlyNet.toFixed(0);
      if (el.netAnnuel && activeId !== 'netAnnuel') el.netAnnuel.value = (monthlyNet * nbMois).toFixed(0);

      if(el.coutCharges) el.coutCharges.textContent = Math.round(chargesSal).toLocaleString('fr-FR');
      if(el.netImposable) el.netImposable.textContent = Math.round(monthlyImposable).toLocaleString('fr-FR');
      if(el.coutEmployeur) el.coutEmployeur.textContent = Math.round(coutTotal).toLocaleString('fr-FR');
      
      if(el.badgeStatut) {
          const statutLabel = el.statut.options[el.statut.selectedIndex].text.split(' ')[1].toUpperCase();
          el.badgeStatut.textContent = statutLabel;
      }
      if(el.gridStatut) el.gridStatut.textContent = el.statut.options[el.statut.selectedIndex].text;

      // SMIC Meter
      if(el.smicTag && monthlyNet > 0) {
        const multiple = (monthlyNet / SMIC_NET_2025).toFixed(1);
        el.smicMultiple.textContent = multiple;
        el.smicTag.classList.remove('hidden');
      }

      // Update Fiche de Paie
      if(el.fpBrut) el.fpBrut.textContent = Math.round(monthlyGross).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.fpTotalCharges) el.fpTotalCharges.textContent = '- ' + Math.round(chargesSal).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.fpNet) el.fpNet.textContent = Math.round(monthlyNet).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.fpCsgNonDed) el.fpCsgNonDed.textContent = Math.round(csgNonDed).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.fpNetImposable) el.fpNetImposable.textContent = Math.round(monthlyImposable).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.fpCoutEmployeur) el.fpCoutEmployeur.textContent = Math.round(coutTotal).toLocaleString('fr-FR') + ' ‚Ç¨';

      // Update PDF Hidden Fields
      if(el.pdfStatut) el.pdfStatut.textContent = el.statut.options[el.statut.selectedIndex].text;
      if(el.pdfBrut) el.pdfBrut.textContent = Math.round(monthlyGross).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfBrutTable) el.pdfBrutTable.textContent = Math.round(monthlyGross).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfCharges) el.pdfCharges.textContent = '-' + Math.round(chargesSal).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfImposable) el.pdfImposable.textContent = Math.round(monthlyImposable).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfNetAvant) el.pdfNetAvant.textContent = Math.round(monthlyNet).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfTauxPas) el.pdfTauxPas.textContent = impot + '%';
      if(el.pdfMontantPas) el.pdfMontantPas.textContent = '-' + Math.round(impotMontant).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfNetApres) el.pdfNetApres.textContent = Math.round(monthlyNetApresImpot).toLocaleString('fr-FR') + ' ‚Ç¨';
      if(el.pdfCoutPatronal) el.pdfCoutPatronal.textContent = Math.round(coutTotal).toLocaleString('fr-FR') + ' ‚Ç¨';


      if (impot > 0) {
        el.blocImpot?.classList.remove('hidden');
        if(el.netApresImpot) el.netApresImpot.textContent = Math.round(monthlyNetApresImpot).toLocaleString('fr-FR');
      } else {
        el.blocImpot?.classList.add('hidden');
      }

      const netPct = ((1 - tauxSal) * 100).toFixed(0);
      if(el.percentNet) el.percentNet.textContent = `${netPct}%`;
      if(el.percentCharges) el.percentCharges.textContent = `${100 - netPct}%`;
      if(el.chartPie) el.chartPie.style.background = `conic-gradient(#2563eb 0% ${netPct}%, #e2e8f0 ${netPct}% 100%)`;

      el.result?.classList.remove('hidden');
      el.result?.classList.add('fade-in');

      updateUrl(monthlyGross, el.statut.value, nbMois === 13, impot);
      
      if(source === 'option') generateGrid();
    };

    const generateGrid = () => {
      if(!el.salaryTableBody) return;
      const levels = [1801.8, 2000, 2500, 3000, 3500, 4000, 5000, 6000]; 
      const tauxSal = RATES[el.statut.value] || 0.22;
      let html = '';
      
      levels.forEach(brut => {
        const net = brut * (1 - tauxSal);
        const imposable = net + (brut * 0.9825 * CSG_NON_DED_RATE);
        const ann = brut * 12;
        
        html += `<tr>
          <td>${ann.toLocaleString('fr-FR')} ‚Ç¨</td>
          <td>${brut.toLocaleString('fr-FR')} ‚Ç¨</td>
          <td class="font-bold text-blue-600 dark:text-blue-400">${Math.round(net).toLocaleString('fr-FR')} ‚Ç¨</td>
          <td class="text-slate-500 dark:text-slate-400">${Math.round(imposable).toLocaleString('fr-FR')} ‚Ç¨</td>
        </tr>`;
      });
      el.salaryTableBody.innerHTML = html;
    };

    const updateUrl = (gross, statut, is13, tax) => {
      try {
        if (!gross) { window.history.replaceState({}, '', window.location.pathname); return; }
        const params = new URLSearchParams();
        params.set('b', Math.round(gross));
        if (statut !== 'non_cadre') params.set('s', statut);
        if (is13) params.set('m', '13');
        if (tax > 0) params.set('t', tax);
        window.history.replaceState({}, '', `${window.location.pathname}?${params.toString()}`);
      } catch (e) {}
    };

    const loadFromUrl = () => {
      try {
        const params = new URLSearchParams(window.location.search);
        const b = params.get('b');
        if (b) {
          if(el.brutMensuel) el.brutMensuel.value = b;
          if (params.get('s') && el.statut) el.statut.value = params.get('s');
          if (params.get('m') === '13' && el.mois13) el.mois13.checked = true;
          if (params.get('t') && el.tauxImpot) el.tauxImpot.value = params.get('t');
          compute('option');
        } else {
          generateGrid();
        }
      } catch (e) {}
    };

    const copyTextToClipboard = (text, successCallback) => {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      textArea.style.top = "0"; textArea.style.left = "0"; textArea.style.position = "fixed"; textArea.style.opacity = "0";
      document.body.appendChild(textArea);
      textArea.focus(); textArea.select();
      try {
        const successful = document.execCommand('copy');
        if (successful && successCallback) successCallback();
      } catch (err) {}
      document.body.removeChild(textArea);
    };

    window.copyLink = () => copyTextToClipboard(window.location.href, () => showMsg('shareMsg'));
    window.copySummary = () => {
      const brut = el.brutMensuel.value;
      const net = el.netMensuel.value;
      const statut = el.statut.options[el.statut.selectedIndex].text;
      const text = `Simulation Salaire (${statut}):\nüëâ Brut: ${brut}‚Ç¨ /mois\nüëâ Net: ${net}‚Ç¨ /mois\nCalcul√© sur PaieNet.fr`;
      copyTextToClipboard(text, () => showMsg('copyTextMsg'));
    };

    const showMsg = (id) => {
      const msg = document.getElementById(id);
      msg?.classList.remove('hidden');
      setTimeout(() => msg?.classList.add('hidden'), 2000);
    };

    // Modal Logic
    window.openModal = (id) => {
      document.getElementById(id).classList.remove('hidden');
      document.body.style.overflow = 'hidden'; 
    };

    window.closeModal = (id) => {
      document.getElementById(id).classList.add('hidden');
      document.body.style.overflow = ''; 
    };

    window.onclick = (event) => {
      const modal = document.getElementById('legalModal');
      if (event.target == modal) {
        closeModal('legalModal');
      }
    };

    window.toggleTheme = () => {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('color-theme', 'light');
        toggleIcons(false);
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('color-theme', 'dark');
        toggleIcons(true);
      }
    };

    function toggleIcons(isDark) {
      document.getElementById('iconSun').classList.toggle('hidden', !isDark);
      document.getElementById('iconMoon').classList.toggle('hidden', isDark);
    }
  </script>
</body>
</html>
